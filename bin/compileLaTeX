#!/usr/bin/env python

import argparse
from pyLaTeX import log
from pyLaTeX.LaTeX import LaTeX

parser = argparse.ArgumentParser(description="Compile LaTeX, creating docx version and tracked changes")
parser.add_argument("texFile",     type=str, help="LaTeX file to compile")
parser.add_argument("-g", "--git", type=str, help="git branch to use as 'old' file in latexdiff for tracked changes")
parser.add_argument("--xelatex",   action='store_true', help='Set to compile using xelatex; default is pdflatex')
parser.add_argument("--docx",      action='store_true', help='Set to create a Microsoft Word docx file.') 
parser.add_argument("--loglevel",  type=int, default=30, help='Set logging level')
parser.add_argument("--debug",     action='store_true')
args = parser.parse_args() 
log.handlers[0].setLevel( args.loglevel )

latex = LaTeX(args.texFile)
latex.compile( xelatex = args.xelatex, gitBranch = args.git, docx = args.docx)

